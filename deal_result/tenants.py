def tenants(tenant_name):
    return {'8x8.com': {'etl_stack': 'etl-ms',
                        'gbm_db': 'gbm1_ms',
                        'gbm_stack': 'gbm1-ms',
                        'pod': 'pod1'},
            'alludo.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod3'},
            'arctiq.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod1'},
            'armis.com': {'etl_stack': 'etl-ms',
                          'gbm_db': 'gbm1_ms',
                          'gbm_stack': 'gbm1-ms',
                          'pod': 'pod1'},
            'aviso.com': {'etl_stack': 'etl-ms',
                          'gbm_db': 'gbm1_ms',
                          'gbm_stack': 'gbm1-ms',
                          'pod': 'pod2'},
            'bmc.com': {'etl_stack': 'etl-ms',
                        'gbm_db': 'gbm1_ms',
                        'gbm_stack': 'gbm1-ms',
                        'pod': 'pod4'},
            'bv.com': {'etl_stack': 'etl-ms',
                       'gbm_db': 'gbm1_ms',
                       'gbm_stack': 'gbm1-ms',
                       'pod': 'pod1'},
            'camunda.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod2'},
            'contractpodai.com': {'etl_stack': 'etl-ms',
                                  'gbm_db': 'gbm1_ms',
                                  'gbm_stack': 'gbm1-ms',
                                  'pod': 'pod5'},
            'conviva.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod2'},
            'data.ai': {'etl_stack': 'etl-ms',
                        'gbm_db': 'gbm1_ms',
                        'gbm_stack': 'gbm1-ms',
                        'pod': 'pod1'},
            'datadome.co': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod1'},
            'datastax.com': {'etl_stack': 'etl-ms',
                             'gbm_db': 'gbm1_ms',
                             'gbm_stack': 'gbm1-ms',
                             'pod': 'pod3'},
            'elastic.co': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod1'},
            'ezesoft.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod3'},
            'github.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod1'},
            'honeywell_gas.com': {'etl_stack': 'etl-ms',
                                  'gbm_db': 'gbm1_ms',
                                  'gbm_stack': 'gbm1-ms',
                                  'pod': 'pod1'},
            'honeywell_ppe.com': {'etl_stack': 'etl-ms',
                                  'gbm_db': 'gbm1_ms',
                                  'gbm_stack': 'gbm1-ms',
                                  'pod': 'pod2'},
            'honeywell_siot.com': {'etl_stack': 'etl-ms',
                                   'gbm_db': 'gbm1_ms',
                                   'gbm_stack': 'gbm1-ms',
                                   'pod': 'pod1'},
            'honeywell_sst.com': {'etl_stack': 'etl-ms',
                                  'gbm_db': 'gbm2_ms',
                                  'gbm_stack': 'gbm2-ms',
                                  'pod': 'pod1'},
            'ironclad.com': {'etl_stack': 'etl-ms',
                             'gbm_db': 'gbm1_ms',
                             'gbm_stack': 'gbm1-ms',
                             'pod': 'pod1'},
            'ivision.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod5'},
            'jfrog.com': {'etl_stack': 'etl-ms',
                          'gbm_db': 'gbm1_ms',
                          'gbm_stack': 'gbm1-ms',
                          'pod': 'pod3'},
            'launchdarkly.com': {'etl_stack': 'etl-ms',
                                 'gbm_db': 'gbm1_ms',
                                 'gbm_stack': 'gbm1-ms',
                                 'pod': 'pod3'},
            'lenovo.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod4'},
            'lumen.com': {'etl_stack': 'etl-ms',
                          'gbm_db': 'gbm2_ms',
                          'gbm_stack': 'gbm2-ms',
                          'pod': 'pod1'},
            'medius.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod3'},
            'movella.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm2_ms',
                            'gbm_stack': 'gbm2-ms',
                            'pod': 'pod1'},
            'mural.co': {'etl_stack': 'etl-ms',
                         'gbm_db': 'gbm1_ms',
                         'gbm_stack': 'gbm1-ms',
                         'pod': 'pod2'},
            'netapp.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod2'},
            'newrelic.com': {'etl_stack': 'etl-ms',
                             'gbm_db': 'gbm1_ms',
                             'gbm_stack': 'gbm1-ms',
                             'pod': 'pod1'},
            'nextech.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod1'},
            'nuance.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod1'},
            'onetrust.com': {'etl_stack': 'etl-ms',
                             'gbm_db': 'gbm1_ms',
                             'gbm_stack': 'gbm1-ms',
                             'pod': 'pod5'},
            'processmap.com': {'etl_stack': 'etl-ms',
                               'gbm_db': 'gbm1_ms',
                               'gbm_stack': 'gbm1-ms',
                               'pod': 'pod1'},
            'redhelix.co.uk': {'etl_stack': 'etl-ms',
                               'gbm_db': 'gbm1_ms',
                               'gbm_stack': 'gbm1-ms',
                               'pod': 'pod2'},
            'redislabs.com': {'etl_stack': 'etl-ms',
                              'gbm_db': 'gbm1_ms',
                              'gbm_stack': 'gbm1-ms',
                              'pod': 'pod1'},
            'rescale.com': {'etl_stack': 'etl-ms',
                            'gbm_db': 'gbm1_ms',
                            'gbm_stack': 'gbm1-ms',
                            'pod': 'pod2'},
            'ringcentral.com': {'etl_stack': 'etl-ms',
                                'gbm_db': 'gbm1_ms',
                                'gbm_stack': 'gbm1-ms',
                                'pod': 'pod2'},
            'servicenow.com': {'etl_stack': 'etl-ms',
                               'gbm_db': 'gbm1_ms',
                               'gbm_stack': 'gbm1-ms',
                               'pod': 'pod1'},
            'silverpeak.com': {'etl_stack': 'etl-ms',
                               'gbm_db': 'gbm1_ms',
                               'gbm_stack': 'gbm1-ms',
                               'pod': 'pod1'},
            'singular.net': {'etl_stack': 'etl-ms',
                             'gbm_db': 'gbm1_ms',
                             'gbm_stack': 'gbm1-ms',
                             'pod': 'pod2'},
            'sourceday.com': {'etl_stack': 'etl-ms',
                              'gbm_db': 'gbm1_ms',
                              'gbm_stack': 'gbm1-ms',
                              'pod': 'pod3'},
            'ssc.com': {'etl_stack': 'etl-ms',
                        'gbm_db': 'gbm1_ms',
                        'gbm_stack': 'gbm1-ms',
                        'pod': 'pod3'},
            'ssi.com': {'etl_stack': 'etl-ms',
                        'gbm_db': 'gbm1_ms',
                        'gbm_stack': 'gbm1-ms',
                        'pod': 'pod1'},
            'ukg.com': {'etl_stack': 'etl-ms',
                        'gbm_db': 'gbm1_ms',
                        'gbm_stack': 'gbm1-ms',
                        'pod': 'pod2'},
            'vastdata.com': {'etl_stack': 'etl-ms',
                             'gbm_db': 'gbm1_ms',
                             'gbm_stack': 'gbm1-ms',
                             'pod': 'pod2'},
            'velocityglobal.com': {'etl_stack': 'etl-ms',
                                   'gbm_db': 'gbm1_ms',
                                   'gbm_stack': 'gbm1-ms',
                                   'pod': 'pod1'},
            'venafi.com': {'etl_stack': 'etl-ms',
                           'gbm_db': 'gbm1_ms',
                           'gbm_stack': 'gbm1-ms',
                           'pod': 'pod1'},
            'wiz.io': {'etl_stack': 'etl-ms',
                       'gbm_db': 'gbm1_ms',
                       'gbm_stack': 'gbm1-ms',
                       'pod': 'pod5'}}.get(tenant_name, {'etl_stack': 'etl-ms',
                                                         'gbm_stack': 'gbm1-ms',
                                                         'pod': 'pod1'})


def ms_connection_strings(pod):
    import os
    mongo_instance = {'pod1': 'db-microservice.aviso.com',
                      'pod2': 'db-microservice-pod2.aviso.com',
                      'pod3': 'db-microservice-pod3.aviso.com',
                      'pod4': 'db-microservice-pod4.aviso.com',
                      'pod5': 'db-microservice-pod5.aviso.com',
                      'stage': 'stagedb.aviso.com',
                      'dev': 'db-etl-qa.avisoaws.com'}.get(pod)
    username = os.environ['MONGO_USERNAME']
    if pod in ['pod1', 'pod2', 'pod3', 'pod4', 'pod5']:
        password = os.environ['MONGO_PASSWORD']
    else:
        password = os.environ['MONGO_PASSWORD_STAGE']
    return "mongodb://" + username + ":" + password + "@" + mongo_instance + ":27017/?authMechanism=DEFAULT&authSource=admin"


def fa_connection_strings(stack, tenant_name):
    import os
    from dotenv import load_dotenv
    load_dotenv()
    username = os.environ['MONGO_USERNAME']
    if stack == 'app':
        cluster = {'8x8.com': '2',
                   'alludo.com': '0',
                   'arctiq.com': '0',
                   'armis.com': '5',
                   'aviso.com': '0',
                   'bmc.com': '4',
                   'bv.com': '0',
                   'camunda.com': '2',
                   'contractpodai.com': '1',
                   'conviva.com': '0',
                   'data.ai': '2',
                   'datadome.co': '0',
                   'datastax.com': '5',
                   'elastic.co': '0',
                   'ezesoft.com': '4',
                   'github.com': '0',
                   'honeywell_gas.com': '2',
                   'honeywell_ppe.com': '1',
                   'honeywell_siot.com': '1',
                   'honeywell_sst.com': '4',
                   'ironclad.com': '5',
                   'ivision.com': '3',
                   'jfrog.com': '5',
                   'launchdarkly.com': '5',
                   'lenovo.com': '3',
                   'lumen.com': '2',
                   'medius.com': '5',
                   'movella.com': '0',
                   'mural.co': '2',
                   'netapp.com': '1',
                   'newrelic.com': '2',
                   'nextech.com': '3',
                   'nuance.com': '0',
                   'onetrust.com': '5',
                   'processmap.com': '3',
                   'redhelix.co.uk': '2',
                   'redislabs.com': '1',
                   'rescale.com': '3',
                   'ringcentral.com': '0',
                   'servicenow.com': '3',
                   'silverpeak.com': '3',
                   'singular.net': '0',
                   'sourceday.com': '3',
                   'ssc.com': '0',
                   'ssi.com': '3',
                   'ukg.com': '0',
                   'vastdata.com': '0',
                   'velocityglobal.com': '5',
                   'venafi.com': '2',
                   'wiz.io': '0'}.get(tenant_name, '3')
        mongo_instance = 'mongo-fmapp-prod-shard' + cluster + '-0.aviso.com'
        password = os.environ['MONGO_PASSWORD']
    elif stack == 'stage':
        mongo_instance = 'mongo-fmapp-stage-shard0-0.aviso.com'
        password = os.environ['MONGO_PASSWORD_STAGE']
    else:
        mongo_instance = 'mongo-fmapp-qa-shard0-0.aviso.com'
        password = os.environ['MONGO_PASSWORD']
    return "mongodb://" + username + ":" + password + "@" + mongo_instance + ":27016/?tls=true"


def get_bastion_server(stack):
    import os
    from dotenv import load_dotenv
    load_dotenv()
    from sshtunnel import SSHTunnelForwarder
    if stack == 'app':
        remote_bind_address = 'rds-microservice-prod.avisoaws.com'
    else:
        remote_bind_address = 'rds-qa-microservice.avisoaws.com'
    return SSHTunnelForwarder(
        ('bastion.aviso.com', 54863),
        ssh_username=os.environ['BASTION_USERNAME'],
        ssh_password=os.environ['BASTION_PASSWORD'],
        ssh_pkey=os.path.expanduser('~/.ssh/faizan_aviso'),
        allow_agent=False,
        remote_bind_address=(remote_bind_address, 5432))


def get_postgres_connection():
    return {u'discrepancy': {},
            u'ds_type': u'uip',
            u'fields': {},
            u'file_types': {},
            u'maps': {},
            u'models': {u'bookings_rtfm': {u'algorithm_params': {u'acv_bw': 10000.0,
                                                                 u'days_in_stage_bw': 45,
                                                                 u'days_to_close_bw': 45,
                                                                 u'days_to_close_dist_add': 0,
                                                                 u'decay_per_day': 5,
                                                                 u'num_cycles': 4,
                                                                 u'owner_diff_dist': 0.1,
                                                                 u'previous_next_time_in_stage': False,
                                                                 u'seasonality': [1],
                                                                 u'small_kernel_weight': 2.0,
                                                                 u'small_num_neighbors': 25,
                                                                 u'small_num_neighbors_ratio': 0.05},
                                           u'config': {u'additional_indexes': {u'uipfield~CloseDate_adj': {}}},
                                           u'field_map': {},
                                           u'history_filter': {},
                                           u'name': u'bookings_rtfm',
                                           u'record_filter': {},
                                           u'type': u'forecast5.Forecast5'},
                        u'common': {u'algorithm_params': {u'anchor_period_type': u'M',
                                                          u'holiday': u'us_holidays'},
                                    u'config': {u'ae_efficiency_config': {u'amount_field': u'Amount_USD',
                                                                          u'commit_config': {u'field': u'ManagerForecastCategory',
                                                                                             u'vals': [u'Commit']},
                                                                          u'lead_config': {},
                                                                          u'owner_name_field': u'Owner',
                                                                          u'sales_adherence_config': {u'spa_fields': {u'Champion__Name': u'Champion Identified',
                                                                                                                      u'Identify_Pain_Business': u'Pain Point Identified'}},
                                                                          u'sales_segment_config': {u'dataset': u'Account',
                                                                                                    u'field': u'GTM_Segment__c',
                                                                                                    u'vals': {u'enterprise': [u'Strategic 10K',
                                                                                                                              u'Enterprise 5K',
                                                                                                                              u'Growth Commercial 100-1K',
                                                                                                                              u'General Commercial 2.5K-5K'],
                                                                                                              u'mid_market': [u'Growth Mid-Market <1K',
                                                                                                                              u'Growth Mid-Market 100-1K',
                                                                                                                              u'General Mid-Market 1K-2.5K',
                                                                                                                              u'Upper Mid-Market 2.5K-5K',
                                                                                                                              u'Mid Commercial 1K-2.5K']}},
                                                                          u'type_config': {u'expansion': [u'Upsell Business Indirect',
                                                                                                          u'Existing Business Direct',
                                                                                                          u'Existing Business Indirect',
                                                                                                          u'Upsell Direct',
                                                                                                          u'Upsell Indirect'],
                                                                                           u'new_business': [u'New Business Indirect', u'New Business Direct'],
                                                                                           u'renewal': [u'Renewal Indirect',
                                                                                                        u'Renewal Direct',
                                                                                                        u'Upsell + Renewal Direct',
                                                                                                        u'Upsell + Renewal Indirect',
                                                                                                        u'Renewal Business Indirect'],
                                                                                           u'type_field': u'Type'}},
                                                u'bands_config': {u'force_reduce_bands': True},
                                                u'chipotle_config': {u'terminal_date_filter': False},
                                                u'er_config': {u'mult': 0.9},
                                                u'fastlane_config': {u'use_core_show': True},
                                                u'fc_config': [u'N/A', u'Outside', u'Best Case', u'Commit', u'Close_Won'],
                                                u'kubeflow': {u'closedater_predictions_config': {u'output_fields': [u'as_of',
                                                                                                                    u'opp_id'],
                                                                                                 u'predict_field': u'cd_results'},
                                                              u'closedater_training_config': {u'eval_metric': u'mcc',
                                                                                              u'preset': u'good_quality',
                                                                                              u'target': u'closedate',
                                                                                              u'time_limit': 3600},
                                                              u'epf_predictions_config': {u'output_fields': [u'as_of', u'type'],
                                                                                          u'predict_field': u'epf_forecast'},
                                                              u'epf_training_config': {u'eval_metric': u'median_absolute_error',
                                                                                       u'preset': u'good_quality',
                                                                                       u'target': u'label',
                                                                                       u'time_limit': 3600},
                                                              u'pullin_predictions_config': {u'output_fields': [u'as_of', u'opp_id'],
                                                                                             u'predict_field': u'pullin'},
                                                              u'pullin_training_config': {u'eval_metric': u'f1',
                                                                                          u'preset': u'good_quality',
                                                                                          u'target': u'label',
                                                                                          u'time_limit': 3600,
                                                                                          u'train_file': u'pullin_feature.PQ'},
                                                              u'pushout_predictions_config': {u'output_fields': [u'as_of', u'opp_id'],
                                                                                              u'predict_field': u'pushout'},
                                                              u'pushout_training_config': {u'eval_metric': u'f1',
                                                                                           u'preset': u'good_quality',
                                                                                           u'target': u'label',
                                                                                           u'time_limit': 3600,
                                                                                           u'train_file': u'pushout_feature.PQ'},
                                                              u'upf_bu_predictions_config': {u'output_fields': [u'as_of',
                                                                                                                u'owner',
                                                                                                                u'type'],
                                                                                             u'predict_field': u'unborn'},
                                                              u'upf_bu_training_config': {u'eval_metric': u'median_absolute_error',
                                                                                          u'preset': u'good_quality',
                                                                                          u'target': u'unborn',
                                                                                          u'time_limit': 3600},
                                                              u'upf_predictions_config': {u'output_fields': [u'as_of', u'type'],
                                                                                          u'predict_field': u'upf_forecast'},
                                                              u'upf_training_config': {u'eval_metric': u'mape',
                                                                                       u'preset': u'good_quality',
                                                                                       u'target': u'label',
                                                                                       u'time_limit': 3600},
                                                              u'winscore_predictions_config': {u'output_fields': [u'as_of',
                                                                                                                  u'opp_id',
                                                                                                                  u'OwnerID',
                                                                                                                  u'pivots',
                                                                                                                  u'new_amount',
                                                                                                                  u'renewal_amount'],
                                                                                               u'predict_field': u'win'},
                                                              u'winscore_training_config': {u'eval_metric': u'mcc',
                                                                                            u'preset': u'good_quality',
                                                                                            u'target': u'label',
                                                                                            u'time_limit': 3600,
                                                                                            u'train_file': u'winscore_feature.PQ'}},
                                                u'kubeflow_config': {u'enabled': True},
                                                u'kubeflow_win_score_config': {u'required_fields': [u'as_of_OID',
                                                                                                    u'active_amount'],
                                                                               u'scale_win_probs': True,
                                                                               u'transform_lambda': u'lambda dtls,asof: (0.5*dtls["win_prob"])+(0.5*0.6) if dtls["ManagerForecastCategory"]=="Commit" and dtls["win_prob"] < 0.3 else (0.5*dtls["win_prob"])+(0.5*0.4) if dtls["ManagerForecastCategory"]=="Best Case" and dtls["win_prob"] < 0.2 else dtls["win_prob"]',
                                                                               u'win_prob_threshold': 0.38,
                                                                               u'win_score_low': 0.04},
                                                u'lose_stages': [u'-1'],
                                                u'outq_pipeline_config': {u'amount_fields': {u'net_new_amount': u'netnew_amount',
                                                                                             u'renewal_amount': u'renewal_amount'},
                                                                          u'data_prep_config': {u'opps': {u'snapshot_interval': 7},
                                                                                                u'time_queries': {u'no_of_next_periods': 3,
                                                                                                                  u'no_of_previous_periods': 4}},
                                                                          u'model_predictions_config': {u'attainment': {u'output_fields': [u'node',
                                                                                                                                           u'cd_quarter',
                                                                                                                                           u'cd_rel',
                                                                                                                                           u'weeks_to_boq',
                                                                                                                                           u'asof_net_new_openpipe',
                                                                                                                                           u'boq_net_new_openpipe',
                                                                                                                                           u'deals_count',
                                                                                                                                           u'asof_net_new_openpipe_early',
                                                                                                                                           u'asof_net_new_openpipe_mature',
                                                                                                                                           u'gap_target_net_new_openpipe',
                                                                                                                                           u'asof_renewal_openpipe',
                                                                                                                                           u'net_new_amount_mean',
                                                                                                                                           u'asof_net_new_openpipe_per_owner',
                                                                                                                                           u'pipe_coverage',
                                                                                                                                           u'plan_adj',
                                                                                                                                           u'asof_expansion_openpipe'],
                                                                                                                        u'predict_field': u'attainment'}},
                                                                          u'model_training_config': {u'attainment': {u'eval_metric': u'mean_absolute_percentage_error',
                                                                                                                     u'features': [u'node',
                                                                                                                                   u'cd_rel',
                                                                                                                                   u'days_to_boq',
                                                                                                                                   u'asof_net_new_openpipe',
                                                                                                                                   u'net_new_amount_mean',
                                                                                                                                   u'net_new_amount_median',
                                                                                                                                   u'asof_renewal_openpipe',
                                                                                                                                   u'renewal_amount_mean',
                                                                                                                                   u'renewal_amount_median',
                                                                                                                                   u'deals_count',
                                                                                                                                   u'age_mean',
                                                                                                                                   u'age_median',
                                                                                                                                   u'days_to_close_mean',
                                                                                                                                   u'days_to_close_median',
                                                                                                                                   u'owners_count',
                                                                                                                                   u'deals_per_owner',
                                                                                                                                   u'asof_net_new_openpipe_per_owner',
                                                                                                                                   u'asof_net_new_openpipe_early',
                                                                                                                                   u'asof_net_new_openpipe_mature',
                                                                                                                                   u'net_new_amount_mean_early',
                                                                                                                                   u'net_new_amount_mean_mature',
                                                                                                                                   u'net_new_amount_median_early',
                                                                                                                                   u'net_new_amount_median_mature',
                                                                                                                                   u'asof_renewal_openpipe_early',
                                                                                                                                   u'asof_renewal_openpipe_mature',
                                                                                                                                   u'renewal_amount_mean_early',
                                                                                                                                   u'renewal_amount_mean_mature',
                                                                                                                                   u'renewal_amount_median_early',
                                                                                                                                   u'renewal_amount_median_mature',
                                                                                                                                   u'deals_count_early',
                                                                                                                                   u'deals_count_mature',
                                                                                                                                   u'age_mean_early',
                                                                                                                                   u'age_mean_mature',
                                                                                                                                   u'age_median_early',
                                                                                                                                   u'age_median_mature',
                                                                                                                                   u'days_to_close_mean_early',
                                                                                                                                   u'days_to_close_mean_mature',
                                                                                                                                   u'days_to_close_median_early',
                                                                                                                                   u'days_to_close_median_mature',
                                                                                                                                   u'owners_count_early',
                                                                                                                                   u'owners_count_mature',
                                                                                                                                   u'boq_net_new_openpipe',
                                                                                                                                   u'boq_renewal_openpipe',
                                                                                                                                   u'gap_target_net_new_openpipe',
                                                                                                                                   u'prev_net_new_openpipe',
                                                                                                                                   u'prev_renewal_openpipe',
                                                                                                                                   u'prev_deals_count',
                                                                                                                                   u'prev_age_mean',
                                                                                                                                   u'prev_net_new_openpipe_early',
                                                                                                                                   u'prev_net_new_openpipe_mature',
                                                                                                                                   u'prev_renewal_openpipe_early',
                                                                                                                                   u'prev_renewal_openpipe_mature',
                                                                                                                                   u'future_net_new_openpipe',
                                                                                                                                   u'future_renewal_openpipe',
                                                                                                                                   u'future_deals_count',
                                                                                                                                   u'future_age_mean',
                                                                                                                                   u'future_net_new_openpipe_early',
                                                                                                                                   u'future_net_new_openpipe_mature',
                                                                                                                                   u'future_renewal_openpipe_early',
                                                                                                                                   u'future_renewal_openpipe_mature',
                                                                                                                                   u'plan_adj',
                                                                                                                                   u'pipe_coverage'],
                                                                                                                     u'model_file': u'attainment_model.tgz',
                                                                                                                     u'preset': u'good_quality',
                                                                                                                     u'stratify': False,
                                                                                                                     u'target': u'attainment_adj',
                                                                                                                     u'test_size': 0.3,
                                                                                                                     u'time_limit': 1200},
                                                                                                     u'other_files': {u'boq_openpipe': u'boq_openpipe.csv',
                                                                                                                      u'eoq_bookings': u'eoq_bookings.csv',
                                                                                                                      u'insights_references': u'insights_references.csv'}}},
                                                u'segment_config': {u'amount_fld': u'as_of_Amount_USD',
                                                                    u'amounts': {u'Industry': [u'as_of_ID_seg_amt'],
                                                                                 u'Sales Vertical': [u'as_of_SV_seg_amt'],
                                                                                 u'Type': [u'as_of_Type_seg_amt'],
                                                                                 u'Use Case': [u'as_of_UC_seg_amt']},
                                                                    u'show_forecast': False,
                                                                    u'terminal_fate_fld': u'as_of_terminal_fate'},
                                                u'stage_config': [22, 38, 42, 78, 91, 99],
                                                u'viewgen_config': {u'drilldown_config': {u'Global': {u'hier': u'Global',
                                                                                                      u'node': u'default',
                                                                                                      u'split': None,
                                                                                                      u'unborn_field': u'as_of_Amount_USD'},
                                                                                          u'TAM': {u'hier': u'TAM',
                                                                                                   u'node': u'default',
                                                                                                   u'split': None,
                                                                                                   u'unborn_field': u'as_of_Amount_USD'}},
                                                                    u'hier_config': {u'Global': {u'leaf_field': u'as_of_OwnerID',
                                                                                                 u'versioned': True},
                                                                                     u'TAM': {u'leaf_field': u'as_of_OID', u'versioned': True}},
                                                                    u'node_config': {u'default': {}},
                                                                    u'split_config': {}},
                                                u'win_stages': [u'99']},
                                    u'field_map': {u'acv': u'Amount_USD',
                                                   u'close_date': u'CloseDate_adj',
                                                   u'orig_close_date': u'CloseDate',
                                                   u'orig_stage': u'StageTrans',
                                                   u'owner': u'OwnerID',
                                                   u'raw_stage': u'Stage_adj',
                                                   u'stage': u'StageTrans_adj',
                                                   u'terminal_fate_fld': u'terminal_fate',
                                                   u'type': u'TypeTrans'},
                                    u'history_filter': {u'not_in(checkAmount)': [u'true'],
                                                        u'not_in(checkType)': [u'true']},
                                    u'name': u'common',
                                    u'record_filter': {u'in(Stage_adj,use_value=as_of)': [u'Qualify',
                                                                                          u'Scope',
                                                                                          u'Validate',
                                                                                          u'Propose',
                                                                                          u'Close',
                                                                                          u'Closed Won',
                                                                                          u'Closed Lost'],
                                                       u'not_in(GEO)': [u'HQ'],
                                                       u'not_in(LossReason)': [u'Duplicate', u'Cancelled'],
                                                       u'not_in(Stage,use_value=as_of)': [u'SFDCDELETED'],
                                                       u'not_in(checkAmount)': [u'true'],
                                                       u'not_in(checkType)': [u'true']},
                                    u'type': u'common'},
                        u'existingpipeforecast': {u'algorithm_params': {u'acv_bw': 10000.0,
                                                                        u'days_in_stage_bw': 45,
                                                                        u'days_to_close_bw': 45,
                                                                        u'days_to_close_dist_add': 0,
                                                                        u'decay_per_day': 5,
                                                                        u'num_cycles': 4,
                                                                        u'owner_diff_dist': 0.1,
                                                                        u'previous_next_time_in_stage': False,
                                                                        u'seasonality': [1],
                                                                        u'small_kernel_weight': 2.0,
                                                                        u'small_num_neighbors': 25,
                                                                        u'small_num_neighbors_ratio': 0.05},
                                                  u'config': {u'additional_indexes': {u'uipfield~CloseDate_adj': {}}},
                                                  u'field_map': {},
                                                  u'history_filter': {},
                                                  u'name': u'existingpipeforecast',
                                                  u'record_filter': {},
                                                  u'type': u'forecast5.Forecast5'},
                        u'fwd_epf': {u'algorithm_params': {u'acv_bw': 10000.0,
                                                           u'days_in_stage_bw': 45,
                                                           u'days_to_close_bw': 45,
                                                           u'days_to_close_dist_add': 0,
                                                           u'decay_per_day': 5,
                                                           u'num_cycles': 4,
                                                           u'owner_diff_dist': 0.1,
                                                           u'previous_next_time_in_stage': False,
                                                           u'seasonality': [1],
                                                           u'small_kernel_weight': 2.0,
                                                           u'small_num_neighbors': 25,
                                                           u'small_num_neighbors_ratio': 0.05},
                                     u'config': {u'additional_indexes': {u'uipfield~CloseDate_adj': {}}},
                                     u'field_map': {},
                                     u'history_filter': {},
                                     u'name': u'fwd_epf',
                                     u'record_filter': {},
                                     u'type': u'forecast5.Forecast5'},
                        u'fwd_npf': {u'algorithm_params': {u'model_scheme': {u'name': u'mean'},
                                                           u'num_cycles': 1,
                                                           u'redist_scheme': {u'name': u'proportional',
                                                                              u'no_new_drilldowns': True,
                                                                              u'prop_fld': u'Amount',
                                                                              u'redist_hierarchy': u'frozen_Level_0~frozen_Level_1~frozen_Level_2~frozen_Level_3~frozen_Owner'},
                                                           u'v2enabled': False},
                                     u'config': {u'master_buffer_size': 1000000},
                                     u'field_map': {u'first_ts_as_created_date': u'StageTrans_adj',
                                                    u'terminal_fate': u'terminal_fate'},
                                     u'history_filter': {},
                                     u'name': u'fwd_npf',
                                     u'record_filter': {},
                                     u'type': u'forecast.UnbornForecastZD'},
                        u'newpipeforecast': {u'algorithm_params': {u'model_scheme': {u'name': u'mean'},
                                                                   u'num_cycles': 4,
                                                                   u'redist_scheme': {u'name': u'proportional',
                                                                                      u'no_new_drilldowns': True,
                                                                                      u'prop_fld': u'Amount',
                                                                                      u'redist_hierarchy': u'frozen_Level_0~frozen_Level_1~frozen_Level_2~frozen_Level_3~frozen_Owner'},
                                                                   u'v2enabled': True},
                                             u'config': {u'master_buffer_size': 1000000, u'statute_of_limitations': 30},
                                             u'field_map': {u'first_ts_as_created_date': u'StageTrans_adj',
                                                            u'terminal_fate': u'terminal_fate'},
                                             u'history_filter': {},
                                             u'name': u'newpipeforecast',
                                             u'record_filter': {},
                                             u'type': u'forecast.UnbornForecastZD'},
                        u'newpipeforecast_rtfm': {u'algorithm_params': {u'model_scheme': {u'name': u'precomputed_mults'},
                                                                        u'num_cycles': 8,
                                                                        u'redist_scheme': {u'name': u'proportional',
                                                                                           u'no_new_drilldowns': True,
                                                                                           u'prop_fld': u'Amount',
                                                                                           u'redist_hierarchy': u'frozen_Level_0~frozen_Level_1~frozen_Level_2~frozen_Level_3~frozen_Owner'}},
                                                  u'config': {u'master_buffer_size': 1000000},
                                                  u'field_map': {u'first_ts_as_created_date': u'StageTrans_adj',
                                                                 u'terminal_fate': u'terminal_fate'},
                                                  u'history_filter': {},
                                                  u'name': u'newpipeforecast_rtfm',
                                                  u'record_filter': {},
                                                  u'type': u'forecast.UnbornForecastZD'}},
            u'name': u'OppDS',
            u'params': {u'general': {u'dimensions': [],
                                     u'drilldown_config': {u'hs_impl': u'A'},
                                     u'uip_version': 1.0,
                                     u'uipfield': [u'Account',
                                                   u'LeadSource',
                                                   u'Opportunity',
                                                   u'StageTransfloat_adj',
                                                   u'Type',
                                                   u'as_of_Account',
                                                   u'as_of_Amount',
                                                   u'as_of_Amount_USD',
                                                   u'as_of_Amount_USD_lud',
                                                   u'as_of_Amount_USD_prev',
                                                   u'as_of_Amount_USD_prev_wk',
                                                   u'as_of_Amount_changes',
                                                   u'as_of_CloseDate',
                                                   u'as_of_CloseDate_adj',
                                                   u'as_of_CloseDate_adj_lud',
                                                   u'as_of_CloseDate_adj_prev',
                                                   u'as_of_CloseDate_adj_prev_wk',
                                                   u'as_of_CloseDate_months_pushed',
                                                   u'as_of_CloseDate_total_pulls',
                                                   u'as_of_CloseDate_total_pushes',
                                                   u'as_of_ForecastCategory',
                                                   u'as_of_ForecastCategory_lud',
                                                   u'as_of_ForecastCategory_prev',
                                                   u'as_of_ForecastCategory_prev_wk',
                                                   u'as_of_Opportunity',
                                                   u'as_of_Owner',
                                                   u'as_of_OwnerID',
                                                   u'as_of_Stage',
                                                   u'as_of_StageTrans',
                                                   u'as_of_StageTrans_adj',
                                                   u'as_of_Stage_adj',
                                                   u'as_of_Stage_lud',
                                                   u'as_of_Stage_prev',
                                                   u'as_of_Stage_prev_wk',
                                                   u'as_of_UIStage',
                                                   u'created_date_adj',
                                                   u'latest_Account',
                                                   u'latest_Opportunity',
                                                   u'terminal_fate',
                                                   u'ManagerForecastCategory',
                                                   u'Upside_ACV',
                                                   u'TCV_Amount',
                                                   u'NextSteps',
                                                   u'Source',
                                                   u'Primary_Competitor',
                                                   u'Sales_Vertical',
                                                   u'Age_In_Stage',
                                                   u'Primary_SA',
                                                   u'Use_Case',
                                                   u'Term',
                                                   u'ClosingMonth',
                                                   u'Stage_Date',
                                                   u'Age_In_Opp',
                                                   u'Industry',
                                                   u'PartnerName',
                                                   u'PartnerID',
                                                   u'Why_Buy_Armis',
                                                   u'Why_Buy_Now',
                                                   u'Identify_Pain_Technical',
                                                   u'Identify_Pain_Business',
                                                   u'Champion',
                                                   u'Economic_Buyer',
                                                   u'Biz_Decision_Criteria',
                                                   u'Tech_Decision_Criteria',
                                                   u'Paper_Process',
                                                   u'Champion__Name',
                                                   u'Ecomonic_Buyer_Name',
                                                   u'checkType',
                                                   u'checkAmount',
                                                   u'latest_Engagement_grade',
                                                   u'NextSteps_lud',
                                                   u'NextSteps_prev',
                                                   u'RecordType',
                                                   u'as_of_AccountID',
                                                   u'Days_in_stage_formula',
                                                   u'Days_in_current_stage',
                                                   u'ManagerForecastCategory_prev',
                                                   u'New_Amount',
                                                   u'CloseDateNext15D',
                                                   u'CloseDateNext7D',
                                                   u'Filter_LastModified',
                                                   u'Age',
                                                   u'Target_Type',
                                                   u'Amountchanges',
                                                   u'Filter_Close_LastModified',
                                                   u'ACV TORQ',
                                                   u'ACV AVM',
                                                   u'ACV MTM',
                                                   u'ACV Platform',
                                                   u'ACV Services',
                                                   u'as_of_OID',
                                                   u'NextStepHistory',
                                                   u'as_of_newsource',
                                                   u'Email',
                                                   u'AccountOwner',
                                                   u'AssignedTAM',
                                                   u'AssignedCEM',
                                                   u'AccountType',
                                                   u'ACV',
                                                   u'RenewalACV',
                                                   u'Filter_Closedate_Stage',
                                                   u'Filter_Closedate',
                                                   u'Upsell_ACV',
                                                   u'Land_ACV',
                                                   u'Expand_ACV',
                                                   u'AccountDomain',
                                                   u'as_of_Type_seg_amt',
                                                   u'as_of_SV_seg_amt',
                                                   u'as_of_UC_seg_amt',
                                                   u'as_of_ID_seg_amt',
                                                   u'as_of_NewLogo',
                                                   u'OwnerEmail',
                                                   u'AccDomain',
                                                   u'Status',
                                                   u'Account_Segmentation',
                                                   u'Partner_Resell',
                                                   u'Partner_Distributor',
                                                   u'Marketplace_Procured',
                                                   u'VIPR_PRO_ACV',
                                                   u'ATI_ACV',
                                                   u'ATI_PRO_ACV',
                                                   u'ACV_HC',
                                                   u'ACV_OT',
                                                   u'POV_Stage',
                                                   u'LastModifiedDate',
                                                   u'Sourcing_Partner',
                                                   u'ManagerForecastCategory_prev',
                                                   u'ManagerForecastCategory_prev_wk',
                                                   u'ManagerForecastCategory_lud',
                                                   u'DeploymentPartner',
                                                   u'DeploymentApproach',
                                                   u'LossReason',
                                                   u'RepForecastCategory',
                                                   u'GEO',
                                                   u'ContractStartDate',
                                                   u'ContractEndDate'],
                                     u'uipfield_types': {u'LastModifiedDate': u'float'},
                                     u'weekly_report_dimensions': []}}}



def get_s3_connection():
    import os
    import boto3
    return boto3.client('s3', aws_access_key_id=os.environ['AWS_USERNAME'],
                        aws_secret_access_key=os.environ['AWS_PASSWORD'])
